(function() {
  'use strict';

  angular.module('desafio', [
    'ui.router',
    'ngAnimate',
    'ngAria',
    'ngMaterial',
    'ngSanitize',
    'shots.widget',
    'shot.widget'
  ])
  .config(function($urlRouterProvider, $locationProvider, $mdThemingProvider) {
    $urlRouterProvider.otherwise("/");
    $locationProvider.html5Mode(true);

    $mdThemingProvider.theme('default')
      .primaryPalette('grey')
      .accentPalette('blue-grey');
  });
})();
(function() {
  'use strict';

  angular
  .module('api.dribble.shots', [])
  .factory('Shots', function($http) {
    var Shots = {};

    Shots.popular = function() {
    	return $http.jsonp('//api.dribbble.com/v1/shots?access_token=137ef56c6219971a9e471892ca3ba330467298294886bf2519bc4d602c3b4a98&callback=JSON_CALLBACK');
    };

    return Shots;
  });

})();
(function() {
  'use strict';

angular
  .module('shots.widget', ['api.dribble.shots'])
  .config(configShots);

configShots.$inject = [
  "$stateProvider"
];

function configShots($stateProvider) {
  $stateProvider
    .state('shots', {
      url: '/',
      views: {
        '': {
          templateUrl: '/app/shots/views/shots.html',
          controller: 'ShotsController',
          controllerAs: 'vm',
          resolve: {
            shots: ["Shots", function(Shots) { 
                return Shots
                  .popular()
                  .then(function (shots) {
                    return shots.data.data;
                }, function (error) {
                  console.log("erro :: ", error);
                  return [];
                });             
            }]            
          }
        }
      }
    })
    ;
}

})();

(function() {
  'use strict';

angular
  .module('shots.widget')
  .controller('ShotsController', ShotsController);

ShotsController.$inject = [ 'shots' ];

function ShotsController( shots ) {

  var vm = this;

  vm.shots = shots;

}

})();
angular
  .module('shot.widget', [])
  .directive('shot', shot);

shot.$inject = ['$compile', '$templateRequest'];

function shot($compile, $templateRequest) {
  return {
    restrict: 'AE',
    replace: true,
    transclude: false,
    scope: {
      shot: '='
    },
    templateUrl: '/app/shots/views/shot.html',
    link: function (scope, element, attrs) {

      scope.show = false;

      scope.showHideDetails = function() {
        scope.show = !scope.show;
      };
    }
  };
}